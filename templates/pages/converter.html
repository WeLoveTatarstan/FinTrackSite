{% extends 'base.html' %}
{% load static %}
{% block title %}Конвертатор · FinTrack{% endblock %}
{% block content %}
<h1 class="title">Конвертер валют</h1>

<div class="card" style="margin-bottom:18px;">
  <div class="form" style="grid-template-columns: 1fr 1fr; gap:12px;">
    <div class="field">
      <label>Сумма</label>
      <input type="number" id="amount" value="1" min="0" step="0.01">
    </div>
    <div class="field">
      <label>Из валюты</label>
      <select id="from">
        {% for code, rate in rates.items %}
          <option value="{{ code }}" {% if code == base_currency %}selected{% endif %}>{{ code }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="field">
      <label>В валюту</label>
      <select id="to">
        {% for code, rate in rates.items %}
          <option value="{{ code }}">{{ code }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="field">
      <label>Результат</label>
      <input type="text" id="result" readonly>
    </div>
  </div>
  <button class="btn primary" id="convertBtn" style="margin-top:10px;">Конвертировать</button>
  <p class="muted">Курсы статичны и заданы для демонстрации.</p>
  <script src="{% static 'js/converter.js' %}"></script>
  <script>
    window.CONVERTER_RATES = {{ rates|safe }};
  </script>
  </div>

<div class="card">
  <h2 class="title" style="font-size:18px;">Курсы валют (база: {{ base_currency }})</h2>
  
  <!-- Элементы управления -->
  <div style="display: flex; gap: 12px; margin-bottom: 16px; flex-wrap: wrap; align-items: center;">
    <!-- Поиск -->
    <div style="flex: 1; min-width: 200px;">
      <input type="text" id="currencySearch" placeholder="Поиск валюты..." style="width: 100%; padding: 8px 12px; border: 1px solid #e6ecf8; border-radius: 6px; font-size: 14px;">
    </div>
    
    <!-- Сортировка -->
    <div style="display: flex; gap: 8px; align-items: center;">
      <label style="font-size: 14px; color: #7082a6;">Сортировка:</label>
      <select id="sortBy" style="padding: 8px 12px; border: 1px solid #e6ecf8; border-radius: 6px; font-size: 14px;">
        <option value="code-asc">Код валюты (А-Я)</option>
        <option value="code-desc">Код валюты (Я-А)</option>
        <option value="rate-asc">Курс (по возрастанию)</option>
        <option value="rate-desc">Курс (по убыванию)</option>
      </select>
    </div>
  </div>

  <!-- Таблица валют -->
  <div id="currencyTableContainer">
    <table id="currencyTable" style="width:100%;border-collapse:collapse">
      <thead>
        <tr>
          <th style="text-align:left;padding:8px;color:#7082a6;font-weight:500;">Валюта</th>
          <th style="text-align:right;padding:8px;color:#7082a6;font-weight:500;">Курс</th>
        </tr>
      </thead>
      <tbody id="currencyTableBody">
        {% for code, rate in rates.items %}
        <tr style="border-top:1px solid #e6ecf8" data-code="{{ code }}" data-rate="{{ rate }}">
          <td style="padding:10px 8px;">{{ code }}</td>
          <td style="padding:10px 8px;text-align:right;">{{ rate }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Пагинация -->
  <div id="pagination" style="display: flex; justify-content: center; align-items: center; gap: 8px; margin-top: 16px; padding-top: 16px; border-top: 1px solid #e6ecf8;">
    <button id="prevPage" class="btn secondary" style="padding: 6px 12px; font-size: 14px;" disabled>← Предыдущая</button>
    <span id="pageInfo" style="font-size: 14px; color: #7082a6;">Страница 1 из 1</span>
    <button id="nextPage" class="btn secondary" style="padding: 6px 12px; font-size: 14px;" disabled>Следующая →</button>
  </div>
</div>

<div class="card" style="margin-top:18px;">
  <h2 class="title" style="font-size:18px;">Драгоценные металлы (USD за тройскую унцию)</h2>
  <table style="width:100%;border-collapse:collapse">
    <thead>
      <tr>
        <th style="text-align:left;padding:8px;color:#7082a6;font-weight:500;">Металл</th>
        <th style="text-align:right;padding:8px;color:#7082a6;font-weight:500;">Цена, $</th>
      </tr>
    </thead>
    <tbody>
      {% for code, price in metals.items %}
      <tr style="border-top:1px solid #e6ecf8">
        <td style="padding:10px 8px;">{{ code }}</td>
        <td style="padding:10px 8px;text-align:right;">{{ price }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}


